meta:
  schema_version: 8
  generated_at_utc: '2026-01-25T15:10:34.205176Z'
  purpose: Audit rubric for ChatGPT-led audits. Defines PASS/PARTIAL/DEBT criteria per domain and requirement.
  result_levels:
  - PASS
  - PARTIAL
  - DEBT
  updated_at_utc: '2026-01-25T22:52:16.477878Z'
global:
  definitions:
    PASS: Implemented completely, deterministic, normed, and with clear error behavior.
    PARTIAL: Implemented but incomplete/ambiguous/subset-only, or implemented without explicit norm.
    DEBT: Missing/contradicts norm/non-deterministic, or ambiguous authority/duplicate truth.
  classification_rules:
  - If behavior exists and is describable but the norm is missing/unclear => PARTIAL (documentation/spec debt).
  - If behavior is missing, contradicts the norm, or is non-deterministic => DEBT (implementation debt).
  - If two truths exist (duplicate authorities) => DEBT until resolved.
  certification:
    notes:
    - 'C3 certification gate for ALL_v5: UNKNOWN=0, CFG has no DEBT, UTILS has no PARTIAL.'
    profiles:
      C3_ALL_v5:
        description: Certification gate for long-term sustainable AM2 (C3).
        scope: ALL_v5
        hard_requirements:
        - rule: UNKNOWN == 0
          severity: BLOCKER
        - rule: domain(CFG) has no DEBT
          severity: BLOCKER
        - rule: domain(UTILS) has no PARTIAL
          severity: BLOCKER
        blockers:
          CFG:
          - CFG-05
          UTILS:
          - UTILS-01
          - UTILS-02
          - UTILS-03
          - UTILS-04
          - UTILS-05
          - UTILS-06
        interpretation:
          CFG-05: 'Closed configuration contract: unknown keys outside extensions namespace MUST error.'
          UTILS: UTILS is first-class audited domain; no requirement may remain PARTIAL at certification time.
authoritative_roots:
  requirements: docs/architecture/audiomason_v2_requirements.yaml
  behaviors: docs/behavior_catalog.yaml
  parity_inventory: docs/parity/am1_inventory.yaml
  parity_log: docs/parity/p9_implementation_log.yaml
  traceability: docs/traceability.yaml
  contracts_dir: contracts/
domains:
  CFG:
    name: Configuration
    scope:
    - configuration sources
    - precedence rules
    - merge rules (partial config)
    - validation and error handling
    - effective (final) configuration state
    - observability (value origin/source)
    normative_baseline:
      precedence:
      - CLI
      - ENV
      - FILE
      - DEFAULT
    policies:
      CFG-05:
        name: Unknown keys and extensions namespace
        mode: EXTENSIONS_NAMESPACE
        yaml_extension_prefix: x_
        env_extension_prefix: AUDIOMASON_X_
        env_scanning_rule: ONLY_AUDIOMASON_PREFIX_OR_ALLOWLIST
        unknown_outside_extensions: ERROR
        extension_behavior: ALLOW_AND_IGNORE_UNLESS_CONSUMED
        observability:
          extension_entry_fields:
          - key
          - source
          - status
          status_values:
          - ignored(no_consumer)
          - consumed(<consumer_name>)
    requirements:
    - id: CFG-01
      title: Configuration sources
      what_to_check:
      - Supported sources are explicitly defined and limited to CLI, ENV, config file (YAML), defaults.
      - No hidden/magic sources beyond the declared list.
      pass_criteria:
      - Each source has clear scope and supported keys.
      - All configuration inputs come only from declared sources.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CFG-02
      title: Precedence
      norm: CLI > ENV > config file > defaults
      pass_criteria:
      - Precedence holds per-key across all supported keys.
      - No path allows a lower layer to override a higher layer.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CFG-03
      title: Merge rules (partial configuration)
      norm: Partial configs are allowed; missing values are filled deterministically from lower layers.
      pass_criteria:
      - Per-key merge is deterministic.
      - Defaults never override an explicitly provided higher-layer value.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CFG-04
      title: Validation (types, constraints)
      norm: Each supported key has defined validity rules (type/range/format). Invalid values => deterministic ERROR.
      pass_criteria:
      - Invalid values produce deterministic ERROR (no silent coercion unless explicitly specified).
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CFG-05
      title: Unknown keys and extensions (Policy C)
      norm_ref: domains.CFG.policies.CFG-05
      pass_criteria:
      - Unknown keys outside extensions => deterministic ERROR (YAML, and ENV under scanning rule).
      - Extensions are visible in debug/audit output with status ignored/consumed.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        blocker: true
        profile: C3_ALL_v5
    - id: CFG-06
      title: Determinism
      norm: Same inputs => same effective configuration.
      pass_criteria:
      - No time-, randomness-, or host-dependent hidden dependencies outside declared sources.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CFG-07
      title: Effective configuration (final state)
      norm: Single final effective config after composition; no silent mutation later.
      pass_criteria:
      - Effective config is created deterministically and is not mutated silently later.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CFG-08
      title: Observability (origin/source of values)
      norm: For each effective key, winning source layer is discoverable at least in debug/audit mode.
      pass_criteria:
      - 'For each key: {value, source_layer} is available.'
      - Extensions are listed with status (ignored/consumed).
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/core/config.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: CFG-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-07
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CFG-08
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    contracts:
    - id: CON-CFG-EXTENSIONS
      path: contracts/cfg_extensions.contract.yaml
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.CFG
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
    certification:
      profile: C3_ALL_v5
      blockers:
      - CFG-05
  LOG:
    name: Logging
    requirements:
    - id: LOG-01
      title: Logging modes and verbosity control
      what_to_check:
      - Verify log modes exist (quiet/normal/verbose/debug or equivalent) and map to deterministic severity thresholds.
      - Check that verbosity selection is global (applies across commands) and does not rely on hidden globals.
      - Confirm invalid mode selection yields a clear error and deterministic exit code.
      pass_criteria:
      - A documented/implemented mapping from mode -> minimum level exists and is used everywhere logging occurs.
      - Mode selection is derived exclusively from config precedence and is testable.
      - Invalid mode leads to deterministic error (no silent fallback).
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/yaml_log.py
        - src/audiomason/cli/main.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: LOG-02
      title: Log output destinations (stdout/stderr/files)
      what_to_check:
      - 'Check supported output destinations: stdout/stderr and optional file path(s).'
      - Verify directory creation policy and permissions errors are handled deterministically.
      - Confirm that 'quiet' does not leak non-error output except mandatory errors.
      pass_criteria:
      - At least one destination is supported and documented; selection is deterministic and precedence-controlled.
      - When file output is configured, files are created predictably and failures are reported.
      - Quiet mode suppresses non-essential output as specified.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/yaml_log.py
        - src/audiomason/cli/main.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: LOG-03
      title: Structured log format and schema
      what_to_check:
      - Confirm structured logging format (YAML/JSON) and schema fields (timestamp, level, event, message, context).
      - Verify stable ordering of keys/fields and deterministic serialization.
      - Check schema versioning or backward-compat policy exists.
      pass_criteria:
      - Logs are emitted in one structured format with stable schema; required fields always present.
      - Serialization is deterministic (stable key order; stable list ordering).
      - Schema changes are versioned or explicitly documented.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/yaml_log.py
        - src/audiomason/cli/main.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: LOG-04
      title: Error and exception logging policy
      what_to_check:
      - 'Check policy for exceptions: captured vs propagated; inclusion of stack traces in debug.'
      - Verify error messages are user-oriented and avoid leaking sensitive info by default.
      - Confirm exit codes are consistent for equivalent failures.
      pass_criteria:
      - Exceptions follow a consistent policy across CLI commands; debug includes trace, normal does not unless specified.
      - Error text and exit codes are deterministic.
      - No silent exception swallowing for core failures.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/yaml_log.py
        - src/audiomason/cli/main.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: LOG-05
      title: Determinism and ordering
      what_to_check:
      - Check ordering of log events across runs for same inputs (no reliance on unordered structures).
      - Verify timestamps are handled in a way compatible with determinism goals (or clearly marked non-deterministic fields).
      - Confirm concurrency (if any) does not cause nondeterministic log ordering unless explicitly allowed.
      pass_criteria:
      - Event ordering is deterministic for single-threaded paths; nondeterministic fields are marked/isolated.
      - If concurrency exists, ordering policy is documented and stable.
      - Log output is reproducible for fixed fixtures (aside from explicitly allowed fields).
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/yaml_log.py
        - src/audiomason/cli/main.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: LOG-06
      title: Observability and traceability fields
      what_to_check:
      - 'Verify traceability fields exist: input path, pipeline id, run id, config sources, plugin set, etc.'
      - Confirm traceability is available at least in verbose/debug modes.
      - Check that traceability does not require reading hidden global state.
      pass_criteria:
      - Traceability fields are present and documented; at least debug exposes full context.
      - Traceability can be enabled via config/CLI and is deterministic.
      - No hidden ambient state is required to reconstruct run context.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/yaml_log.py
        - src/audiomason/cli/main.py
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: LOG-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: LOG-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: LOG-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: LOG-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: LOG-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: LOG-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.LOG
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  FS:
    name: Filesystem
    requirements:
    - id: FS-01
      title: Path handling and normalization
      what_to_check:
      - Validate path normalization rules (absolute/relative handling, symlinks if relevant).
      - Confirm consistent handling of trailing slashes and directory vs file inputs.
      - Check that path resolution is deterministic across OS locale differences.
      pass_criteria:
      - Paths are normalized deterministically and consistently across commands.
      - Invalid path kinds produce deterministic errors.
      - Normalization rules are documented.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import <PATH>:
          - type: returncode_equals
            value: 2
          - type: stdout_contains_any
            value:
            - 'Input not found: <PATH>'
            - 'import: status=error'
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/fs/
        symbols_any_of:
        - publish
        - normalize_path
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: FS-02
      title: Naming rules and conventions
      what_to_check:
      - Check naming conventions for outputs (files/dirs) and where they are defined.
      - Verify that naming is configurable and defaults are stable.
      - Confirm that naming changes do not break other modules (anti-monolith boundary).
      pass_criteria:
      - Naming rules are centralized (one authority) and applied consistently.
      - Defaults are stable; configuration can override where allowed.
      - Cross-module contracts for names/paths are explicit.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason import --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/fs/
        symbols_any_of:
        - publish
        - normalize_path
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: FS-03
      title: Publish/move/copy semantics
      what_to_check:
      - Confirm publish semantics (move/copy/link) are explicit and deterministic.
      - Verify idempotency behavior when destination exists.
      - Check behavior on cross-device moves and permission failures.
      pass_criteria:
      - Publish operation is explicitly chosen and documented; outcome is deterministic for same inputs.
      - Existing destination handling is specified (overwrite/skip/error).
      - Failures are reported with deterministic exit codes.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import <PATH>:
          - type: returncode_equals
            value: 2
          - type: stdout_contains_any
            value:
            - 'Input not found: <PATH>'
            - 'import: status=error'
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/fs/
        symbols_any_of:
        - publish
        - normalize_path
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: FS-04
      title: Atomicity and safety guarantees
      what_to_check:
      - Check atomicity guarantees for writes (temp + rename) where appropriate.
      - Verify no partial outputs are left on failure (or policy is documented).
      - Confirm cleanup policy for temporary directories.
      pass_criteria:
      - Writes are atomic where feasible; partial outputs follow explicit policy.
      - Temporary artifacts are cleaned up deterministically.
      - Failure paths leave repo/state consistent.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import <PATH>:
          - type: returncode_equals
            value: 2
          - type: stdout_contains_any
            value:
            - 'Input not found: <PATH>'
            - 'import: status=error'
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/fs/
        symbols_any_of:
        - publish
        - normalize_path
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: FS-05
      title: Cache and temp directories behavior
      what_to_check:
      - Verify cache directories and temp directories locations and precedence control.
      - Check that cache keys are deterministic.
      - Confirm cache can be disabled/cleared by config.
      pass_criteria:
      - Cache locations are deterministic and configurable; defaults documented.
      - Cache behavior does not change outputs (only performance), unless explicitly allowed.
      - Cache can be controlled (disable/clear) deterministically.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason import --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/fs/
        symbols_any_of:
        - publish
        - normalize_path
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: FS-06
      title: Error handling for filesystem failures
      what_to_check:
      - Check error handling for missing files, unreadable paths, disk full, permission denied.
      - Verify errors are surfaced to user with consistent messages.
      - Confirm no silent fallbacks that mask issues.
      pass_criteria:
      - All common FS failures have deterministic handling and clear messages.
      - Exit codes are consistent across commands for same failure class.
      - No silent ignore of critical FS failures.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import <PATH>:
          - type: returncode_equals
            value: 2
          - type: stdout_contains_any
            value:
            - 'Input not found: <PATH>'
            - 'import: status=error'
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/fs/
        symbols_any_of:
        - publish
        - normalize_path
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: FS-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: FS-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: FS-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: FS-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: FS-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: FS-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.FS
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  PIPE:
    name: Pipeline
    requirements:
    - id: PIPE-01
      title: Pipeline definition loading and validation
      what_to_check:
      - Validate pipeline YAML loading, schema, and unknown-key policy.
      - Confirm deterministic resolution of includes/references if any.
      - Check error messages for invalid pipeline definitions.
      pass_criteria:
      - Pipeline files are validated deterministically; invalid schema yields clear errors.
      - Unknown keys follow policy (error or extensions namespace).
      - Loading is deterministic given same input.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/pipeline/
        symbols_any_of:
        - plan
        - execute
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PIPE-02
      title: Planner behavior (deterministic plan)
      what_to_check:
      - Check planner creates deterministic plan ordering for same pipeline.
      - Verify planner does not read hidden global state.
      - Confirm plan is inspectable in debug/verbose.
      pass_criteria:
      - Plan ordering is stable; same pipeline + inputs -> same plan.
      - Plan can be emitted/inspected deterministically.
      - No ambient state affects plan.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/pipeline/
        symbols_any_of:
        - plan
        - execute
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PIPE-03
      title: Executor behavior (step execution semantics)
      what_to_check:
      - 'Check executor semantics: step boundaries, inputs/outputs, and determinism.'
      - Verify error propagation policy (stop vs continue).
      - Confirm step results are recorded for reporting.
      pass_criteria:
      - Execution semantics are documented and stable.
      - Failures follow explicit policy; results are reported.
      - Outputs are deterministic for fixed fixtures (aside from allowed fields).
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/pipeline/
        symbols_any_of:
        - plan
        - execute
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PIPE-04
      title: Failure policy and rollback/cleanup
      what_to_check:
      - Verify cleanup/rollback policy on failure.
      - Check that partial artifacts are handled explicitly.
      - Confirm idempotency across reruns.
      pass_criteria:
      - Failure cleanup policy exists and is deterministic.
      - Reruns with same inputs are safe and predictable.
      - No accumulating junk outside explicit cache/temp.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason run <INPUT> --pipeline <PIPE>:
          - type: returncode_equals
            value: 2
          - type: stderr_contains_any
            value:
            - Invalid value for '--pipeline'
            - Try 'python -m audiomason run --help'
      implementation_markers:
        files_any_of:
        - src/audiomason/pipeline/
        symbols_any_of:
        - plan
        - execute
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PIPE-05
      title: Concurrency rules (if any) and constraints
      what_to_check:
      - If concurrency exists, verify constraints and determinism policy.
      - Confirm concurrency can be disabled.
      - Check for race conditions affecting outputs/logs.
      pass_criteria:
      - Concurrency, if present, is explicitly controlled and does not break determinism beyond allowed bounds.
      - Default behavior is deterministic.
      - Disabling concurrency yields reproducible order.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/pipeline/
        symbols_any_of:
        - plan
        - execute
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PIPE-06
      title: Reporting of pipeline outcomes
      what_to_check:
      - 'Check reporting of pipeline outcome: status, per-step results, artifacts.'
      - Verify schema and output destinations are consistent.
      - Confirm machine-readable output exists if required.
      pass_criteria:
      - Outcome reporting is stable and schema-defined.
      - Artifacts and statuses are traceable to inputs/config.
      - Output format is deterministic.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason run --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/pipeline/
        symbols_any_of:
        - plan
        - execute
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: PIPE-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PIPE-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PIPE-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PIPE-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PIPE-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PIPE-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.PIPE
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  CLI:
    name: Command-line interface
    requirements:
    - id: CLI-01
      title: Command surface and help/usage correctness
      what_to_check:
      - Verify command surface matches specification and help text is accurate.
      - Check that help does not crash and lists all commands/options.
      - Confirm deterministic formatting of help/output.
      pass_criteria:
      - '`--help` works for root and subcommands; no exceptions.'
      - Help lists commands/options correctly.
      - Output formatting is stable (no random ordering).
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason config --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason config --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/cli/
        cli_commands_any_of:
        - run
        - import
        - verify
        - config
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CLI-02
      title: Option parsing and validation
      what_to_check:
      - Check option parsing, validation, and error messages for invalid values.
      - Verify consistent behavior for missing required args.
      - Confirm deterministic exit codes.
      pass_criteria:
      - Invalid options yield clear errors and stable exit codes.
      - Validation is consistent across commands.
      - No silent coercions beyond documented ones.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason config --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason config --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/cli/
        cli_commands_any_of:
        - run
        - import
        - verify
        - config
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CLI-03
      title: Exit codes and error messages
      what_to_check:
      - Verify exit code conventions across commands (success=0, user error, internal error).
      - Check mapping of error types to exit codes.
      - Confirm exit codes are stable across runs.
      pass_criteria:
      - Exit codes follow a documented scheme and are consistent.
      - Same failure class yields same exit code.
      - No mixing stdout/stderr contrary to policy.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason --help
        - python -m audiomason config --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/cli/
        cli_commands_any_of:
        - run
        - import
        - verify
        - config
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CLI-04
      title: Input path rules and globbing behavior
      what_to_check:
      - Check input path rules (file vs directory), globbing, and recursion behavior.
      - Verify that CLI enforces allowed input kinds deterministically.
      - Confirm errors are clear for wrong input kinds.
      pass_criteria:
      - Input validation matches policy; wrong kind yields deterministic error.
      - Globbing/recursion rules are explicit and stable.
      - No ambiguous behavior across OS.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason config --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason config --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/cli/
        cli_commands_any_of:
        - run
        - import
        - verify
        - config
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CLI-05
      title: Verbosity flags integration (quiet/verbose/debug)
      what_to_check:
      - Verify verbosity flags exist and map to logging/output modes globally.
      - Confirm flags override config with correct precedence.
      - Check quiet mode suppresses non-essential output.
      pass_criteria:
      - Flags exist and apply across commands consistently.
      - Precedence is deterministic (CLI overrides).
      - Verbosity behavior matches defined categories.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason --help
        - python -m audiomason config --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
          python -m audiomason config --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/cli/
        cli_commands_any_of:
        - run
        - import
        - verify
        - config
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: CLI-06
      title: Deterministic output and formatting
      what_to_check:
      - Check deterministic output formatting for structured outputs (JSON/YAML).
      - Verify stable ordering in lists/tables where relevant.
      - Confirm consistent newline/encoding policy.
      pass_criteria:
      - Machine-readable outputs are stable and schema-consistent.
      - Ordering is deterministic.
      - Encoding/newlines are consistent.
      runtime_evidence:
        required: false
        commands:
        - python -m audiomason --help
        - python -m audiomason config --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/cli/
        cli_commands_any_of:
        - run
        - import
        - verify
        - config
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: CLI-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CLI-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CLI-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CLI-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CLI-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: CLI-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.CLI
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  DAEMON:
    name: Daemon
    requirements:
    - id: DAEMON-01
      title: Daemon entrypoints and lifecycle (start/stop/foreground/background)
      what_to_check:
      - Confirm daemon behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason daemon --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason start --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason stop --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason status --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/daemon/
        cli_commands_any_of: &id001
        - start
        - stop
        - status
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: DAEMON-02
      title: Signal handling and shutdown behavior
      what_to_check:
      - Confirm daemon behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason daemon --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason start --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason stop --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason status --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/daemon/
        cli_commands_any_of: *id001
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: DAEMON-03
      title: PID/lock/instance safety (if applicable)
      what_to_check:
      - Confirm daemon behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason daemon --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason start --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason stop --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason status --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/daemon/
        cli_commands_any_of: *id001
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: DAEMON-04
      title: Logging and output behavior in daemon mode
      what_to_check:
      - Confirm daemon behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason daemon --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason start --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason stop --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason status --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/daemon/
        cli_commands_any_of: *id001
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: DAEMON-05
      title: Configuration and overrides in daemon mode
      what_to_check:
      - Confirm daemon behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason daemon --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason start --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason stop --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason status --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/daemon/
        cli_commands_any_of: *id001
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: DAEMON-06
      title: Determinism and idempotency of daemon operations
      what_to_check:
      - Confirm daemon behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason daemon --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason start --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason stop --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
          python -m audiomason status --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/daemon/
        cli_commands_any_of: *id001
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: DAEMON-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: DAEMON-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: DAEMON-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: DAEMON-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: DAEMON-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: DAEMON-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.DAEMON
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  IMPORT:
    name: Import
    requirements:
    - id: IMPORT-01
      title: Import inputs and path rules
      what_to_check:
      - Confirm import behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/import/
        cli_commands_any_of: &id002
        - import
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: IMPORT-02
      title: Source discovery and selection rules
      what_to_check:
      - Confirm import behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/import/
        cli_commands_any_of: *id002
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: IMPORT-03
      title: Idempotency and deduplication behavior
      what_to_check:
      - Confirm import behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/import/
        cli_commands_any_of: *id002
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: IMPORT-04
      title: Error handling and partial failures
      what_to_check:
      - Confirm import behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/import/
        cli_commands_any_of: *id002
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: IMPORT-05
      title: Configuration and overrides for import
      what_to_check:
      - Confirm import behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/import/
        cli_commands_any_of: *id002
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: IMPORT-06
      title: Reporting of import outcomes
      what_to_check:
      - Confirm import behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason import --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason import --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/import/
        cli_commands_any_of: *id002
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: IMPORT-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: IMPORT-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: IMPORT-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: IMPORT-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: IMPORT-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: IMPORT-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.IMPORT
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  VERIFY:
    name: Verify
    requirements:
    - id: VERIFY-01
      title: Verify suite composition and default checks
      what_to_check:
      - Confirm verify behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason verify --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason verify --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/verify/
        cli_commands_any_of: &id003
        - verify
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: VERIFY-02
      title: Check registry and extensibility
      what_to_check:
      - Confirm verify behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason verify --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason verify --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/verify/
        cli_commands_any_of: *id003
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: VERIFY-03
      title: Deterministic ordering and output
      what_to_check:
      - Confirm verify behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason verify --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason verify --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/verify/
        cli_commands_any_of: *id003
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: VERIFY-04
      title: Failure policy and exit codes
      what_to_check:
      - Confirm verify behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason verify --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason verify --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/verify/
        cli_commands_any_of: *id003
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: VERIFY-05
      title: Configuration of verify behavior
      what_to_check:
      - Confirm verify behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason verify --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason verify --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/verify/
        cli_commands_any_of: *id003
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: VERIFY-06
      title: Reporting format and schema
      what_to_check:
      - Confirm verify behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason verify --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason verify --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/verify/
        cli_commands_any_of: *id003
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: VERIFY-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: VERIFY-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: VERIFY-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: VERIFY-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: VERIFY-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: VERIFY-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.VERIFY
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  PREFLIGHT:
    name: Preflight
    requirements:
    - id: PREFLIGHT-01
      title: Preflight checks scope and defaults
      what_to_check:
      - Confirm preflight behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason preflight --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason preflight --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/preflight/
        cli_commands_any_of: &id004
        - preflight
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PREFLIGHT-02
      title: Deterministic ordering and output
      what_to_check:
      - Confirm preflight behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason preflight --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason preflight --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/preflight/
        cli_commands_any_of: *id004
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PREFLIGHT-03
      title: Failure policy and exit codes
      what_to_check:
      - Confirm preflight behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason preflight --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason preflight --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/preflight/
        cli_commands_any_of: *id004
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PREFLIGHT-04
      title: Environment and dependency inspection rules
      what_to_check:
      - Confirm preflight behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason preflight --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason preflight --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/preflight/
        cli_commands_any_of: *id004
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PREFLIGHT-05
      title: Configuration of preflight behavior
      what_to_check:
      - Confirm preflight behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason preflight --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason preflight --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/preflight/
        cli_commands_any_of: *id004
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PREFLIGHT-06
      title: Reporting format and schema
      what_to_check:
      - Confirm preflight behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason preflight --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason preflight --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_equals
            value: ''
      implementation_markers:
        files_any_of:
        - src/audiomason/preflight/
        cli_commands_any_of: *id004
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: PREFLIGHT-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PREFLIGHT-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PREFLIGHT-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PREFLIGHT-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PREFLIGHT-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PREFLIGHT-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.PREFLIGHT
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  REPORT:
    name: Report
    requirements:
    - id: REPORT-01
      title: Report schema and required fields
      what_to_check:
      - 'Verify report schema: required fields, types, and versioning.'
      - Confirm reports are machine-readable and stable.
      - Check that missing fields are treated deterministically (error or defaults).
      pass_criteria:
      - Schema exists and is enforced; required fields always present.
      - Serialization is deterministic.
      - Schema versioning/back-compat policy is explicit.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/report/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: REPORT-02
      title: Report output destinations and formats
      what_to_check:
      - Check report output destinations (stdout/file) and selection precedence.
      - Verify directory creation and error handling for write failures.
      - Confirm quiet/normal/verbose/debug influence on report verbosity if applicable.
      pass_criteria:
      - Destination selection is explicit and deterministic.
      - Write failures are handled with clear errors.
      - Verbosity integration is explicit and consistent.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/report/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: REPORT-03
      title: Deterministic ordering and rendering
      what_to_check:
      - Verify deterministic ordering in report lists (tracks, steps, artifacts).
      - Confirm timestamps or nondeterministic fields are isolated/marked.
      - Check that sorting rules are specified.
      pass_criteria:
      - Ordering is deterministic and documented.
      - Allowed nondeterministic fields are explicitly marked.
      - Same inputs yield same report structure.
      runtime_evidence:
        required: false
        commands: []
        fixtures: []
        expected_artifacts: []
        acceptance_checks: []
      implementation_markers:
        files_any_of:
        - src/audiomason/report/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: REPORT-04
      title: Error handling and partial report behavior
      what_to_check:
      - Confirm report behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason describe --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason report --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/report/
        cli_commands_any_of: &id005
        - report
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: REPORT-05
      title: Traceability links (inputs, outputs, sources)
      what_to_check:
      - Confirm report behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason describe --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason report --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/report/
        cli_commands_any_of: *id005
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: REPORT-06
      title: Backward/forward compatibility policy
      what_to_check:
      - Confirm report behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason describe --help
        fixtures: []
        expected_artifacts: []
        acceptance_checks:
          python -m audiomason report --help:
          - type: returncode_equals
            value: 0
          - type: stdout_contains_any
            value:
            - 'Usage:'
          - type: stderr_not_contains_any
            value:
            - No such command
      implementation_markers:
        files_any_of:
        - src/audiomason/report/
        cli_commands_any_of: *id005
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: REPORT-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: REPORT-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: REPORT-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: REPORT-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: REPORT-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: REPORT-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.REPORT
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  METADATA:
    name: Metadata
    requirements:
    - id: METADATA-01
      title: Metadata lookup inputs and sources
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm metadata behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason metadata --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: &id006
        - exit_code == 0
        - stdout parses as YAML/JSON
        - schema_version == 'am2.audit.v1'
        - 'required fields exist: tool, domain, subject, status, checks[]'
        - checks[] is a non-empty list
      implementation_markers:
        files_any_of:
        - src/audiomason/metadata/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: METADATA-02
      title: Caching rules and determinism
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm metadata behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason metadata --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/metadata/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: METADATA-03
      title: Normalization and merge rules
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm metadata behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason metadata --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/metadata/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: METADATA-04
      title: Error handling and fallbacks
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm metadata behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason metadata --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/metadata/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: METADATA-05
      title: Configuration of metadata behavior
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm metadata behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason metadata --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/metadata/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: METADATA-06
      title: Output schema and traceability
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm metadata behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason metadata --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/metadata/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: METADATA-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: METADATA-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: METADATA-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: METADATA-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: METADATA-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: METADATA-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.METADATA
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  TAGS:
    name: Tags
    requirements:
    - id: TAGS-01
      title: Tag extraction and parsing behavior
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm tags behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason tags --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/tags/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: TAGS-02
      title: Supported tag formats (e.g., ID3) and limits
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm tags behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason tags --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/tags/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: TAGS-03
      title: Error handling for missing/invalid tags
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm tags behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason tags --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/tags/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: TAGS-04
      title: Determinism and normalization
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm tags behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason tags --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/tags/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: TAGS-05
      title: Configuration of tagging behavior
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm tags behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason tags --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/tags/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: TAGS-06
      title: Output schema/fields used elsewhere
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm tags behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason tags --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/tags/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: TAGS-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: TAGS-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: TAGS-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: TAGS-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: TAGS-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: TAGS-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.TAGS
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  AUDIO:
    name: Audio
    requirements:
    - id: AUDIO-01
      title: Audio conversion/normalization semantics
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm audio behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason audio --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/audio/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: AUDIO-02
      title: Determinism and reproducibility
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm audio behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason audio --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/audio/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: AUDIO-03
      title: Tooling dependencies and invocation policy
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm audio behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason audio --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/audio/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: AUDIO-04
      title: Error handling and partial results
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm audio behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason audio --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/audio/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: AUDIO-05
      title: Configuration of audio processing
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm audio behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason audio --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/audio/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: AUDIO-06
      title: Output artifact conventions
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm audio behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason audio --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/audio/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: AUDIO-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: AUDIO-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: AUDIO-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: AUDIO-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: AUDIO-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: AUDIO-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.AUDIO
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  COVERS:
    name: Covers
    requirements:
    - id: COVERS-01
      title: Cover retrieval and caching behavior
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm covers behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason covers --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/covers/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: COVERS-02
      title: Storage conventions and naming
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm covers behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason covers --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/covers/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: COVERS-03
      title: Error handling and fallbacks
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm covers behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason covers --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/covers/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: COVERS-04
      title: Determinism and idempotency
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm covers behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason covers --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/covers/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: COVERS-05
      title: Configuration of cover behavior
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm covers behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason covers --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/covers/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: COVERS-06
      title: Output schema/fields
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm covers behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason covers --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/covers/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: COVERS-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: COVERS-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: COVERS-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: COVERS-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: COVERS-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: COVERS-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.COVERS
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  PLUGINS:
    name: Plugins
    requirements:
    - id: PLUGINS-01
      title: Plugin discovery and loading rules
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Verify plugin discovery sources (config list, directory scanning, entry points) are explicit and deterministic.
      - Confirm discovery can be constrained (explicit list) and unknown plugins error per policy.
      - Check that discovery does not execute plugin code before selection is resolved.
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Discovery is deterministic and configuration-driven.
      - Selected plugin set is explicit and traceable.
      - No premature plugin execution during discovery.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason plugins --list --format yaml
        - python -m audiomason plugins --validate --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/plugins/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PLUGINS-02
      title: Isolation and safety constraints
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Verify plugin loading protocol and isolation constraints are explicit.
      - Confirm errors in plugin import/load are handled deterministically.
      - Check that plugin load order is controlled by config (S4=c).
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Loading follows a defined protocol and deterministic order.
      - Plugin load failures are reported consistently.
      - Order is explicit (config) and traceable.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason plugins --list --format yaml
        - python -m audiomason plugins --validate --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/plugins/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PLUGINS-03
      title: Versioning/compatibility policy
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Check plugin API versioning/compatibility policy exists.
      - Verify incompatibility yields deterministic error (not silent partial behavior).
      - Confirm compatibility checks happen before execution.
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Compatibility policy exists and is enforced.
      - Incompatible plugins fail fast with clear errors.
      - No silent fallback for incompatible API versions.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason plugins --list --format yaml
        - python -m audiomason plugins --validate --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/plugins/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PLUGINS-04
      title: Configuration of plugins and extensions
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Verify all plugin-controlled behaviors are configurable via YAML/CLI/ENV (RQ-003) where applicable.
      - Confirm plugin settings are namespaced to avoid collisions (extensions).
      - Check that unknown plugin settings follow the unknown-key policy.
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Plugin config is namespaced and follows unknown-key policy.
      - Configuration is explicit and precedence-controlled.
      - Settings collisions are prevented by design.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason plugins --list --format yaml
        - python -m audiomason plugins --validate --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/plugins/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PLUGINS-05
      title: Determinism and ordering
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Verify determinism and ordering of plugin effects (application order, conflict resolution).
      - Confirm conflicts are resolved deterministically or are errors.
      - Check that plugin effects are traceable in logs/report.
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Plugin effects are applied in deterministic order; conflicts handled deterministically.
      - Traceability of plugin set and decisions exists.
      - No nondeterministic merging of plugin outputs.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason plugins --list --format yaml
        - python -m audiomason plugins --validate --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/plugins/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    - id: PLUGINS-06
      title: Reporting and observability
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Check reporting/observability includes plugin set, versions, and key decisions.
      - Verify debug mode includes full plugin context.
      - Confirm plugin actions are logged in structured format where applicable.
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Reports/logs include plugin context and decisions.
      - Debug exposes full plugin traceability.
      - Structured logging captures plugin actions deterministically.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason plugins --list --format yaml
        - python -m audiomason plugins --validate --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/plugins/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
    policies: {}
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: PLUGINS-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PLUGINS-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PLUGINS-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PLUGINS-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PLUGINS-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: PLUGINS-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.PLUGINS
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
  UTILS:
    name: Utils
    requirements:
    - id: UTILS-01
      title: Utility helpers constraints (no hidden IO/network unless explicit)
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm utils behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 1: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 1 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason utils --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        no_partial_allowed: true
        profile: C3_ALL_v5
    - id: UTILS-02
      title: Determinism requirements for helpers
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm utils behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 2: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 2 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason utils --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        no_partial_allowed: true
        profile: C3_ALL_v5
    - id: UTILS-03
      title: Error handling conventions
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm utils behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 3: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 3 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason utils --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        no_partial_allowed: true
        profile: C3_ALL_v5
    - id: UTILS-04
      title: Path/time/random usage policy
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm utils behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 4: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 4 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason utils --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        no_partial_allowed: true
        profile: C3_ALL_v5
    - id: UTILS-05
      title: Logging conventions in helpers
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm utils behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 5: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 5 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason utils --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        no_partial_allowed: true
        profile: C3_ALL_v5
    - id: UTILS-06
      title: API stability expectations
      what_to_check:
      - 'Static checks via selftest: module import + symbol existence; protocol fields/schema_version.'
      - Confirm utils behavior is explicitly controlled via config/CLI and has stable defaults.
      - Check that the module boundary is respected (no hidden cross-module coupling).
      - Verify deterministic behavior for fixed inputs (or clearly mark allowed nondeterminism).
      - 'Requirement slot 6: see domain-specific criteria below.'
      pass_criteria:
      - Selftest evidence is valid (rc=0, parseable YAML/JSON, expected schema_version, required fields).
      - Explicit configuration knobs exist (with precedence) and defaults are documented/stable.
      - Behavior is reproducible for fixed fixtures within allowed bounds.
      - Errors are handled deterministically with clear messages and exit codes (if CLI-exposed).
      - Requirement slot 6 is satisfied according to the domain's defined criteria.
      runtime_evidence:
        required: true
        commands:
        - python -m audiomason utils --selftest --format yaml
        fixtures: []
        expected_artifacts: []
        acceptance_checks: *id006
      implementation_markers:
        files_any_of:
        - src/audiomason/utils/
      embedded_markers:
        feature_map_key: normative_sources_inline.from_archive_zip.feature_map
        module_map_key: normative_sources_inline.from_archive_zip.module_map
      certification:
        no_partial_allowed: true
        profile: C3_ALL_v5
    policies:
      final_state:
        no_partial_allowed: true
        applies_to_requirements:
        - UTILS-01
        - UTILS-02
        - UTILS-03
        - UTILS-04
        - UTILS-05
        - UTILS-06
        reason: 'B2 + C3: UTILS is first-class audited domain; certification requires PASS or conscious DEBT (prefer PASS).'
    contracts: []
    audit_output_template:
      audit_date: ''
      audited_snapshot: ''
      results:
      - requirement_id: UTILS-01
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: UTILS-02
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: UTILS-03
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: UTILS-04
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: UTILS-05
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
      - requirement_id: UTILS-06
        result: ''
        notes: ''
        evidence: []
        reason: ''
        confidence: ''
        mapped_requirements: []
    evidence_options:
      pytest_junit:
        enabled: true
        artifact_path: audit/results/pytest_junit.xml
        mapping_key: pytest_domain_mapping.matching.by_test_name_prefix.UTILS
        use_for:
        - primary_evidence_when_available
        - increase_confidence
        notes: Use domain-matched pytest results as evidence for PASS/DEBT when available.
    certification:
      profile: C3_ALL_v5
      no_partial_allowed: true
audit_index:
  domains:
  - id: CFG
    name: Configuration
    requirements:
    - CFG-01
    - CFG-02
    - CFG-03
    - CFG-04
    - CFG-05
    - CFG-06
    - CFG-07
    - CFG-08
  - id: LOG
    name: Logging
    requirements:
    - LOG-01
    - LOG-02
    - LOG-03
    - LOG-04
    - LOG-05
    - LOG-06
  - id: FS
    name: Filesystem
    requirements:
    - FS-01
    - FS-02
    - FS-03
    - FS-04
    - FS-05
    - FS-06
  - id: PIPE
    name: Pipeline
    requirements:
    - PIPE-01
    - PIPE-02
    - PIPE-03
    - PIPE-04
    - PIPE-05
    - PIPE-06
  - id: CLI
    name: Command-line interface
    requirements:
    - CLI-01
    - CLI-02
    - CLI-03
    - CLI-04
    - CLI-05
    - CLI-06
  - id: DAEMON
    name: Daemon
    requirements:
    - DAEMON-01
    - DAEMON-02
    - DAEMON-03
    - DAEMON-04
    - DAEMON-05
    - DAEMON-06
  - id: IMPORT
    name: Import
    requirements:
    - IMPORT-01
    - IMPORT-02
    - IMPORT-03
    - IMPORT-04
    - IMPORT-05
    - IMPORT-06
  - id: VERIFY
    name: Verify
    requirements:
    - VERIFY-01
    - VERIFY-02
    - VERIFY-03
    - VERIFY-04
    - VERIFY-05
    - VERIFY-06
  - id: PREFLIGHT
    name: Preflight
    requirements:
    - PREFLIGHT-01
    - PREFLIGHT-02
    - PREFLIGHT-03
    - PREFLIGHT-04
    - PREFLIGHT-05
    - PREFLIGHT-06
  - id: REPORT
    name: Report
    requirements:
    - REPORT-01
    - REPORT-02
    - REPORT-03
    - REPORT-04
    - REPORT-05
    - REPORT-06
  - id: METADATA
    name: Metadata
    requirements:
    - METADATA-01
    - METADATA-02
    - METADATA-03
    - METADATA-04
    - METADATA-05
    - METADATA-06
  - id: TAGS
    name: Tags
    requirements:
    - TAGS-01
    - TAGS-02
    - TAGS-03
    - TAGS-04
    - TAGS-05
    - TAGS-06
  - id: AUDIO
    name: Audio
    requirements:
    - AUDIO-01
    - AUDIO-02
    - AUDIO-03
    - AUDIO-04
    - AUDIO-05
    - AUDIO-06
  - id: COVERS
    name: Covers
    requirements:
    - COVERS-01
    - COVERS-02
    - COVERS-03
    - COVERS-04
    - COVERS-05
    - COVERS-06
  - id: PLUGINS
    name: Plugins
    requirements:
    - PLUGINS-01
    - PLUGINS-02
    - PLUGINS-03
    - PLUGINS-04
    - PLUGINS-05
    - PLUGINS-06
  - id: UTILS
    name: Utils
    requirements:
    - UTILS-01
    - UTILS-02
    - UTILS-03
    - UTILS-04
    - UTILS-05
    - UTILS-06
  module_domain_map: &id007
    src/audiomason/daemon/: DAEMON
    src/audiomason/importing/: IMPORT
    src/audiomason/verify/: VERIFY
    src/audiomason/preflight/: PREFLIGHT
    src/audiomason/report/: REPORT
    src/audiomason/metadata/: METADATA
    src/audiomason/tags/: TAGS
    src/audiomason/audio/: AUDIO
    src/audiomason/covers/: COVERS
    src/audiomason/plugins/: PLUGINS
    src/audiomason/utils/: UTILS
    src/audiomason/pipeline/: PIPE
    src/audiomason/fs/: FS
    src/audiomason/cli/: CLI
    src/audiomason/core/: CFG
audit_output_policy:
  directory: audit/results/
  filename_pattern: audit_<SCOPE>_<YYYY-MM-DD>_<SNAPSHOT>.yaml
  immutable: true
  append_only: true
  rules:
  - Audit results MUST be written as a new YAML file; never modify docs/audit_rubric.yaml during an audit.
  - One audit run produces exactly one result file.
  - Do not delete or overwrite prior audits.
  - Each result file MUST record rubric_version (schema_version) and audited_snapshot.
  - Canonical rubric path is audit/audit_rubric.yaml; do not copy rubric into audit/results/.
  result_file_required_fields:
  - audited_snapshot
  - mapping_used
  - rubric_version
  - scope
module_domain_map: *id007
base_requirements:
  source_file: audiomason_v2_requirements.yaml
  requirements:
  - id: REQ-ARCH-001
    domain: ARCH
    priority: MUST
    statement: No monoliths; functionality must be modular and deterministic.
    source_anchor: principles
  - id: REQ-CONFIG-001
    domain: CONFIG
    priority: MUST
    statement: Configuration precedence is CLI > ENV > config file > defaults.
    source_anchor: config.sources_priority
  - id: REQ-LOG-001
    domain: LOG
    priority: SHOULD
    statement: Logging modes must support silent, normal, verbose, and debug outputs.
    source_anchor: logging.modes
derived_requirements:
  source: Conversation-derived (non-authoritative); used to track additional expectations and audit annotations.
  requirements:
  - id: CRQ-001
    name: AM1 parity (short-term)
    statement: In the current phase, AM2 behavior should match AM1 user-visible behavior; deviations are bugs unless explicitly
      documented.
    horizon: short-term
    maps_to:
    - RQ-003
    - RQ-002
    status: derived
    notes: Operational objective for current phase; not part of the 3 foundational requirements.
  - id: CRQ-002
    name: Unified configuration precedence
    statement: 'Configuration precedence is uniform across the project: CLI > ENV > YAML > DEFAULT.'
    horizon: mid-term
    maps_to:
    - RQ-003
    status: derived
  - id: CRQ-003
    name: Verbosity modes (quiet/normal/verbose/debug) are normed
    statement: Output verbosity modes must be explicitly defined with clear categories and expectations (not only 'more/less
      text').
    horizon: mid-term
    maps_to:
    - RQ-003
    - RQ-002
    status: derived
  - id: CRQ-004
    name: Plugins via declared interfaces
    statement: Plugins may influence broad behavior, but only through declared interfaces (hooks/capabilities) and deterministic
      ordering from configuration.
    horizon: mid-term
    maps_to:
    - RQ-001
    - RQ-002
    - RQ-003
    status: derived
  - id: CRQ-005
    name: Small isolated changes (avoid regressions)
    statement: Prefer small, isolated, auditable changes to prevent a fix in one area breaking multiple others.
    horizon: long-term
    maps_to:
    - RQ-001
    status: derived
  - id: CRQ-006
    name: Audit is state assessment only
    statement: 'Audit output is assessment: PASS/PARTIAL/DEBT with factual justification and what''s missing; no recommendations
      or priority decisions.'
    horizon: process
    maps_to:
    - RQ-002
    - RQ-003
    status: derived
  - id: CRQ-007
    name: ENV allowlist in rubric
    statement: Only a defined allowlist of ENV keys is considered for configuration; the allowlist authority is the audit
      rubric.
    horizon: mid-term
    maps_to:
    - RQ-003
    status: derived
  - id: CRQ-008
    name: Config key authority is code
    statement: The authoritative list and semantics of config keys live in code; YAML documents may mirror but are not the
      source of truth.
    horizon: mid-term
    maps_to:
    - RQ-003
    - RQ-001
    status: derived
audit_requirement_mapping:
  rules:
  - Each audit requirement MUST map to at least one base requirement (RQ-001..RQ-003).
  - If an audit requirement lacks an explicit mapping, the domain default mapping applies.
  - Derived requirements (CRQ-*) may be referenced by audits but do not override base requirements.
  domain_defaults:
    CFG:
    - RQ-003
    - RQ-002
    LOG:
    - RQ-002
    - RQ-001
    - RQ-003
    FS:
    - RQ-002
    - RQ-001
    - RQ-003
    PIPE:
    - RQ-002
    - RQ-001
    - RQ-003
    CLI:
    - RQ-002
    - RQ-001
    - RQ-003
    DAEMON:
    - RQ-002
    - RQ-001
    - RQ-003
    IMPORT:
    - RQ-002
    - RQ-001
    - RQ-003
    VERIFY:
    - RQ-002
    - RQ-001
    - RQ-003
    PREFLIGHT:
    - RQ-002
    - RQ-001
    - RQ-003
    REPORT:
    - RQ-002
    - RQ-001
    - RQ-003
    METADATA:
    - RQ-002
    - RQ-001
    - RQ-003
    TAGS:
    - RQ-002
    - RQ-001
    - RQ-003
    AUDIO:
    - RQ-002
    - RQ-001
    - RQ-003
    COVERS:
    - RQ-002
    - RQ-001
    - RQ-003
    PLUGINS:
    - RQ-002
    - RQ-001
    - RQ-003
    UTILS:
    - RQ-002
    - RQ-001
    - RQ-003
  explicit_overrides:
    CFG-01:
    - RQ-003
    CFG-02:
    - RQ-003
    CFG-03:
    - RQ-003
    CFG-04:
    - RQ-003
    CFG-05:
    - RQ-003
    CFG-06:
    - RQ-002
    CFG-07:
    - RQ-003
    - RQ-002
    CFG-08:
    - RQ-003
    - RQ-002
audit_result_model:
  result_enum:
  - PASS
  - PARTIAL
  - DEBT
  - UNKNOWN
  partial_reason_enum:
  - PARTIAL_IMPL
  - NO_NORM
  - NO_EVIDENCE
  - RUNTIME_REQUIRED
  - UNKNOWN
  - STALE_EVIDENCE
  - STALE_EVIDENCE_UNCHECKED
  confidence_enum:
  - low
  - medium
  - high
  fields:
  - requirement_id
  - result
  - reason
  - confidence
  - notes
  - evidence
  - mapped_requirements
audit_result_policy:
  result_semantics:
    PASS: All pass criteria satisfied with required evidence.
    PARTIAL: Some implementation exists and some criteria are satisfied, but not all (use reason=PARTIAL_IMPL).
    DEBT: Norm exists and implementation violates it or a required invariant is missing.
    UNKNOWN: Cannot be assessed (missing norm or required evidence).
  rules:
  - Use PARTIAL only when there is positive evidence of partial implementation (reason=PARTIAL_IMPL).
  - Use UNKNOWN when norms are missing, evidence is missing, or runtime evidence is required but not available.
  - Use DEBT only when norms exist and there is clear evidence of violation (not merely missing information).
  - If pytest_junit.xml is missing, set result=UNKNOWN with reason=NO_EVIDENCE for pytest-dependent checks.
  - If pytest_junit.xml is present but violates freshness_policy, set result=UNKNOWN with reason=STALE_EVIDENCE.
  - 'C3_ALL_v5 gate: If any UNKNOWN exists, certification verdict MUST be FAIL.'
  - 'C3_ALL_v5 gate: If domain CFG has any DEBT, certification verdict MUST be FAIL (CFG-05 is a blocker).'
  - 'C3_ALL_v5 gate: If domain UTILS has any PARTIAL, certification verdict MUST be FAIL.'
normative_sources_inline:
  source_note: Embedded sources to allow audits with a single rubric file + repo snapshot. These sources do not override base_requirements;
    they define measurement criteria.
  from_archive_zip:
    feature_map:
    - module: __init__
      functions: []
    - module: __main__
      functions: []
    - module: archives
      functions:
      - _require_tool
      - unpack
    - module: args
      functions: []
    - module: audio
      functions:
      - ffprobe_json
      - m4a_chapters
      - ffmpeg_common_input
      - opus_to_mp3_single
      - m4a_to_mp3_single
      - m4a_split_by_chapters
      - convert_opus_in_place
      - convert_m4a_in_place
    - module: cache_gc
      functions:
      - _is_known_cache_file
      - _iter_entries
      - cache_gc
    - module: cli
      functions:
      - _version_kv_line
      - _parent_parser
      - _parse_args
      - _cmd_requires_config
      - _apply_config_defaults
      - _argv_config_path
      - _apply_builtin_defaults
      - _ns_to_opts
      - main
    - module: config
      functions:
      - _deep_merge
      - _load_yaml
      - user_config_path
      - _validate_prompts_disable
      - load_config
    - module: covers
      functions:
      - extract_embedded_cover_from_mp3
      - convert_image_to_jpg
      - _sha1
      - _sniff_image_ext
      - download_url
      - cover_from_input
      - find_file_cover
      - extract_cover_from_m4a
      - choose_cover
    - module: googlebooks
      functions:
      - _dry_run
      - _norm
      - _author_match
      - _get_json
      - _pick_best
      - suggest_title
      - _dia_score
    - module: guess
      functions:
      - guess_author_book
    - module: ignore
      functions:
      - _resolve_ignore_file
      - load_ignore
      - add_ignore
    - module: import_flow
      functions:
      - _ol_enabled
      - _resolved_preflight_steps
      - _resolved_preflight_disable
      - _resolved_prompts_disable
      - _prompt_disabled
      - _pf_disabled
      - _pf_prompt_yes_no
      - _pf_prompt
      - _build_json_report
      - _ol_offer_top
      - _list_sources
      - _choose_source
      - _reset_dir
      - _stage_source
      - _has_audio_files_here
      - _find_first_m4a
      - _detect_books
      - _choose_books
      - _collect_audio_files
      - _preflight_global
      - _preflight_book
      - _is_dir_nonempty
      - _next_available_title
      - _output_dir
      - _copy_audio_to_out_no_rename
      - _copy_audio_to_out_raw
      - _copy_audio_to_out
      - _apply_book_steps
      - _write_dry_run_summary
      - _process_book
      - _resolve_source_arg
      - _resolved_pipeline_steps
      - _is_interactive
      - _stage_cover_from_raw
      - run_import
      - _norm
      - visit
      - _pl_resolve_target
      - _process_one_source
      - _run_one_source
      - __init__
      - write
      - flush
      - isatty
      - _pl_prompt
      - _pl_prompt_yes_no
      - _norm
      - _step_publish_wipe
      - _step_clean_stage
      - _exec_step
    - module: inspect
      functions:
      - _is_audio
      - _is_archive
      - inspect_source
    - module: manifest
      functions:
      - source_fingerprint
      - manifest_path
      - load_manifest
      - _deep_merge
      - write_manifest_atomic
      - update_manifest
    - module: naming
      functions:
      - normalize_name
      - normalize_sentence
    - module: openlibrary
      functions:
      - _cache_path
      - _cache_load
      - _cache_get
      - _cache_put
      - _get_json
      - validate_author
      - _norm_title
      - _sanitize_title_suggestion
      - _best_title_suggestion
      - _fallback_q
      - _author_match
      - _lang_codes
      - _pick_edition_title
      - validate_book
    - module: paths
      functions:
      - _default_user_base
      - _find_repo_root
      - _env_base
      - require_audiomason_root
      - _data_base
      - _defaults_for
      - _ensure_abs
      - _resolve_path
      - validate_paths_contract
      - _get
      - get_drop_root
      - get_stage_root
      - get_output_root
      - get_archive_root
      - get_cache_root
      - get_ignore_file
    - module: pipeline_steps
      functions:
      - _validate_step_order
      - resolve_pipeline_steps
    - module: preflight_orchestrator
      functions:
      - __init__
      - resolve_order
      - _eligible
      - plan
      - materialize_pending
    - module: preflight_registry
      functions:
      - default_steps
      - validate_steps_list
      - _req
    - module: publish
      functions: []
    - module: rename
      functions:
      - extract_track_num
      - natural_sort
      - rename_sequential
      - key
    - module: state
      functions: []
    - module: tags
      functions:
      - _load_id3
      - wipe_id3
      - write_tags
      - write_cover
    - module: util
      functions:
      - run_cmd
      - out
      - die
      - strip_diacritics
      - clean_text
      - slug
      - two
      - ensure_dir
      - unique_path
      - prompt
      - prompt_yes_no
      - prune_empty_dirs
      - is_url
      - find_archive_match
      - enable_trace
      - __init__
      - _t
      - run
      - check_call
      - check_output
      - __init__
      - _wrap
      - _wrap
      - w
      - w
    - module: verify
      functions:
      - verify_library
    - module: version
      functions:
      - _pkg_version
    module_map:
    - file: __init__.py
      lines: 3
      functions: []
      classes: []
      imports:
      - version
    - file: __main__.py
      lines: 4
      functions: []
      classes: []
      imports:
      - cli
    - file: archives.py
      lines: 38
      functions:
      - _require_tool
      - unpack
      classes: []
      imports:
      - __future__
      - audiomason.util
      - pathlib
    - file: args.py
      lines: 1
      functions: []
      classes: []
      imports: []
    - file: audio.py
      lines: 176
      functions:
      - ffprobe_json
      - m4a_chapters
      - ffmpeg_common_input
      - opus_to_mp3_single
      - m4a_to_mp3_single
      - m4a_split_by_chapters
      - convert_opus_in_place
      - convert_m4a_in_place
      classes: []
      imports:
      - __future__
      - audiomason.util
      - pathlib
    - file: cache_gc.py
      lines: 125
      functions:
      - _is_known_cache_file
      - _iter_entries
      - cache_gc
      classes:
      - CacheEntry
      imports:
      - __future__
      - audiomason.paths
      - audiomason.util
      - dataclasses
      - pathlib
    - file: cli.py
      lines: 457
      functions:
      - _version_kv_line
      - _parent_parser
      - _parse_args
      - _cmd_requires_config
      - _apply_config_defaults
      - _argv_config_path
      - _apply_builtin_defaults
      - _ns_to_opts
      - main
      classes: []
      imports:
      - __future__
      - audiomason.cache_gc
      - audiomason.config
      - audiomason.import_flow
      - audiomason.inspect
      - audiomason.paths
      - audiomason.state
      - audiomason.util
      - audiomason.verify
      - audiomason.version
      - pathlib
      - typing
    - file: config.py
      lines: 184
      functions:
      - _deep_merge
      - _load_yaml
      - user_config_path
      - _validate_prompts_disable
      - load_config
      classes: []
      imports:
      - __future__
      - audiomason.paths
      - audiomason.util
      - audiomason.version
      - pathlib
    - file: covers.py
      lines: 279
      functions:
      - extract_embedded_cover_from_mp3
      - convert_image_to_jpg
      - _sha1
      - _sniff_image_ext
      - download_url
      - cover_from_input
      - find_file_cover
      - extract_cover_from_m4a
      - choose_cover
      classes: []
      imports:
      - __future__
      - audiomason.paths
      - audiomason.util
      - mutagen.id3
      - pathlib
      - typing
    - file: googlebooks.py
      lines: 155
      functions:
      - _dry_run
      - _norm
      - _author_match
      - _get_json
      - _pick_best
      - suggest_title
      - _dia_score
      classes: []
      imports:
      - __future__
      - dataclasses
      - typing
      - urllib.parse
      - urllib.request
    - file: guess.py
      lines: 24
      functions:
      - guess_author_book
      classes: []
      imports:
      - __future__
      - typing
    - file: ignore.py
      lines: 62
      functions:
      - _resolve_ignore_file
      - load_ignore
      - add_ignore
      classes: []
      imports:
      - __future__
      - audiomason.paths
      - audiomason.state
      - audiomason.util
      - pathlib
    - file: import_flow.py
      lines: 1423
      functions:
      - _ol_enabled
      - _resolved_preflight_steps
      - _resolved_preflight_disable
      - _resolved_prompts_disable
      - _prompt_disabled
      - _pf_disabled
      - _pf_prompt_yes_no
      - _pf_prompt
      - _build_json_report
      - _ol_offer_top
      - _list_sources
      - _choose_source
      - _reset_dir
      - _stage_source
      - _has_audio_files_here
      - _find_first_m4a
      - _detect_books
      - _choose_books
      - _collect_audio_files
      - _preflight_global
      - _preflight_book
      - _is_dir_nonempty
      - _next_available_title
      - _output_dir
      - _copy_audio_to_out_no_rename
      - _copy_audio_to_out_raw
      - _copy_audio_to_out
      - _apply_book_steps
      - _write_dry_run_summary
      - _process_book
      - _resolve_source_arg
      - _resolved_pipeline_steps
      - _is_interactive
      - _stage_cover_from_raw
      - run_import
      - _norm
      - visit
      - _pl_resolve_target
      - _process_one_source
      - _run_one_source
      - __init__
      - write
      - flush
      - isatty
      - _pl_prompt
      - _pl_prompt_yes_no
      - _norm
      - _step_publish_wipe
      - _step_clean_stage
      - _exec_step
      classes:
      - BookGroup
      - _PLTee
      imports:
      - __future__
      - audiomason.archives
      - audiomason.audio
      - audiomason.covers
      - audiomason.ignore
      - audiomason.manifest
      - audiomason.naming
      - audiomason.openlibrary
      - audiomason.paths
      - audiomason.pipeline_steps
      - audiomason.preflight_orchestrator
      - audiomason.preflight_registry
      - audiomason.rename
      - audiomason.tags
      - audiomason.util
      - dataclasses
      - pathlib
      - typing
    - file: inspect.py
      lines: 57
      functions:
      - _is_audio
      - _is_archive
      - inspect_source
      classes: []
      imports:
      - __future__
      - audiomason.util
      - pathlib
    - file: manifest.py
      lines: 84
      functions:
      - source_fingerprint
      - manifest_path
      - load_manifest
      - _deep_merge
      - write_manifest_atomic
      - update_manifest
      classes: []
      imports:
      - __future__
      - pathlib
      - typing
    - file: naming.py
      lines: 42
      functions:
      - normalize_name
      - normalize_sentence
      classes: []
      imports:
      - __future__
    - file: openlibrary.py
      lines: 322
      functions:
      - _cache_path
      - _cache_load
      - _cache_get
      - _cache_put
      - _get_json
      - validate_author
      - _norm_title
      - _sanitize_title_suggestion
      - _best_title_suggestion
      - _fallback_q
      - _author_match
      - _lang_codes
      - _pick_edition_title
      - validate_book
      classes:
      - OLResult
      imports:
      - __future__
      - audiomason.googlebooks
      - audiomason.util
      - dataclasses
      - pathlib
      - typing
      - urllib.parse
      - urllib.request
    - file: paths.py
      lines: 200
      functions:
      - _default_user_base
      - _find_repo_root
      - _env_base
      - require_audiomason_root
      - _data_base
      - _defaults_for
      - _ensure_abs
      - _resolve_path
      - validate_paths_contract
      - _get
      - get_drop_root
      - get_stage_root
      - get_output_root
      - get_archive_root
      - get_cache_root
      - get_ignore_file
      classes: []
      imports:
      - __future__
      - audiomason.util
      - pathlib
    - file: pipeline_steps.py
      lines: 71
      functions:
      - _validate_step_order
      - resolve_pipeline_steps
      classes: []
      imports:
      - __future__
      - audiomason.util
    - file: preflight_orchestrator.py
      lines: 88
      functions:
      - __init__
      - resolve_order
      - _eligible
      - plan
      - materialize_pending
      classes:
      - PreflightContext
      - PreflightPlan
      - PreflightOrchestrator
      imports:
      - __future__
      - audiomason.preflight_registry
      - dataclasses
      - typing
    - file: preflight_registry.py
      lines: 174
      functions:
      - default_steps
      - validate_steps_list
      - _req
      classes:
      - PreflightStepMeta
      imports:
      - __future__
      - dataclasses
      - typing
    - file: publish.py
      lines: 1
      functions: []
      classes: []
      imports: []
    - file: rename.py
      lines: 52
      functions:
      - extract_track_num
      - natural_sort
      - rename_sequential
      - key
      classes: []
      imports:
      - __future__
      - pathlib
      - typing
    - file: state.py
      lines: 37
      functions: []
      classes:
      - Opts
      imports:
      - __future__
      - audiomason.version
      - dataclasses
      - pathlib
      - typing
    - file: tags.py
      lines: 90
      functions:
      - _load_id3
      - wipe_id3
      - write_tags
      - write_cover
      classes: []
      imports:
      - __future__
      - audiomason.paths
      - audiomason.util
      - mutagen.id3
      - pathlib
      - typing
    - file: util.py
      lines: 314
      functions:
      - run_cmd
      - out
      - die
      - strip_diacritics
      - clean_text
      - slug
      - two
      - ensure_dir
      - unique_path
      - prompt
      - prompt_yes_no
      - prune_empty_dirs
      - is_url
      - find_archive_match
      - enable_trace
      - __init__
      - _t
      - run
      - check_call
      - check_output
      - __init__
      - _wrap
      - _wrap
      - w
      - w
      classes:
      - AmExit
      - AmConfigError
      - AmValidationError
      - AmExternalToolError
      - AmAbort
      - Popen
      imports:
      - __future__
      - pathlib
      - typing
    - file: verify.py
      lines: 81
      functions:
      - verify_library
      classes: []
      imports:
      - __future__
      - audiomason.naming
      - audiomason.openlibrary
      - audiomason.paths
      - audiomason.util
      - mutagen.id3
      - pathlib
    - file: version.py
      lines: 13
      functions:
      - _pkg_version
      classes: []
      imports:
      - __future__
      - importlib
    parity_spec:
      spec_version: '1.0'
      generated_at: '2026-01-23T20:50:15Z'
      scope:
        constraint: Compare only src/ directories of uploaded archives.
        archives:
        - id: AM1
          path: /mnt/data/audiomason-main.zip
        - id: AM2
          path: /mnt/data/audiomason2-main.zip
        notes:
        - Statements below are derived from static source layout and module presence/absence in src/.
        - This spec does not assert runtime behavior beyond what is implied by the visible CLI entrypoints/modules.
      observations:
        AM1:
          package_root: src/audiomason
          layout: flat modules under audiomason/
          entrypoint:
            file: audiomason/__main__.py
            behavior: Imports .cli.main and exits with SystemExit(main()).
            cli_framework: argparse
          surface_commands_in_src:
          - import (default behavior when no subcommand)
          - verify
          - inspect
          - cache gc
          notable_modules_present:
          - import_flow.py
          - preflight_orchestrator.py
          - preflight_registry.py
          - pipeline_steps.py
          - verify.py
          - covers.py
          - openlibrary.py
          - googlebooks.py
          - publish.py
          - rename.py
          - tags.py
          - manifest.py
          - naming.py
          - guess.py
          - ignore.py
          - archives.py
          - paths.py
        AM2:
          package_root: src/audiomason
          layout: package-oriented (audio/, cli/, core/, pipeline/, metadata/, fs/, daemon/, docs/, plugins/, utils/)
          entrypoint:
            file: audiomason/__main__.py
            behavior: Imports audiomason.cli.main:app and calls app() (main()->None).
            cli_framework: typer
          surface_commands_in_src:
          - run
          - process
          - inspect
          - describe
          - explain
          - config
          - daemon
          - docs build
          direct_path_overlap_with_AM1:
          - audiomason/__init__.py (content differs)
          - audiomason/__main__.py (content differs)
          versioning_note:
            AM1: __init__.py exposes version.__version__
            AM2: __init__.py sets __version__ = '0.0.0'
      parity_gaps:
        missing_in_AM2_by_domain:
          import_workflow:
          - No AM1-like 'import' command surface.
          - No drop_root source selection workflow.
          - No preflight prompt/orchestrator/registry equivalent.
          - No naming/rename/publish orchestration equivalent tied to import.
          metadata_lookup:
          - No OpenLibrary provider equivalent (AM1 openlibrary.py).
          - No GoogleBooks provider equivalent (AM1 googlebooks.py).
          - No runtime enable/disable selection for lookup steps comparable to AM1 CLI/config toggles.
          covers_and_cache:
          - No cover art retrieval equivalent (AM1 covers.py).
          - No cache maintenance surface like 'cache gc' (AM1 cache gc).
          verify:
          - No 'verify' command equivalent (AM1 verify.py) in AM2 src/ CLI surface.
          reporting:
          - No AM1-like JSON/summary reporting contract identified for import/verify parity.
      backlog:
        ordering_principle: Prioritize making AM2 usable as an AM1 replacement for import first; then add verify; then network
          providers and covers.
        items:
        - id: P0.1
          title: Add CLI command 'import' (AM1 mental model)
          depends_on: []
          acceptance:
          - AM2 exposes 'import' command (or alias) under typer CLI.
          - When invoked with PATH, executes deterministic pipeline for import flow.
        - id: P0.2
          title: Default CLI behavior parity (no subcommand => import)
          depends_on:
          - P0.1
          acceptance:
          - Invoking 'python -m audiomason' behaves consistently with chosen parity approach (either default import or explicit
            message with actionable guidance).
        - id: P1.1
          title: Introduce DROP_ROOT and source selection (MVP-1)
          depends_on:
          - P0.1
          acceptance:
          - If PATH omitted, enumerate sources under drop_root.
          - Non-interactive mode is deterministic.
        - id: P2.1
          title: Preflight orchestration and prompt controls
          depends_on:
          - P1.1
          acceptance:
          - Preflight questions can be enabled/disabled via CLI and config.
          - Behavior is deterministic under non-interactive settings.
        - id: P3.1
          title: Implement OpenLibrary metadata provider
          depends_on:
          - P2.1
          acceptance:
          - Provider can be enabled/disabled and integrated as a pipeline step.
        - id: P3.2
          title: Implement GoogleBooks metadata provider
          depends_on:
          - P3.1
          acceptance:
          - Provider works as fallback or complementary source to OpenLibrary.
        - id: P4.1
          title: Implement covers retrieval + disk cache
          depends_on:
          - P3.1
          acceptance:
          - Covers can be retrieved and stored in a cache directory.
          - Cache location is configurable.
        - id: P4.2
          title: Add 'cache gc' command for cover cache maintenance
          depends_on:
          - P4.1
          acceptance:
          - Command exists and performs deterministic cleanup based on policy.
        - id: P5.1
          title: Naming rules parity and deterministic output paths
          depends_on:
          - P0.1
          acceptance:
          - Naming is deterministic and configurable.
        - id: P5.2
          title: Rename/move/publish orchestration
          depends_on:
          - P5.1
          acceptance:
          - Handles overwrite/skip policies deterministically.
          - Optional 'clean inbox' behavior.
        - id: P6.1
          title: Tagging / metadata write parity (or compatible subset)
          depends_on:
          - P5.2
          acceptance:
          - Writes minimal metadata (or sidecar) deterministically.
        - id: P7.1
          title: Add 'verify' command parity
          depends_on:
          - P5.2
          acceptance:
          - Scans library_root and reports issues with stable exit codes.
        - id: P8.1
          title: Machine-readable reporting contract (JSON summary)
          depends_on:
          - P0.1
          acceptance:
          - Import and verify can emit JSON summary for automation.
      mvp_plan:
        MVP-0:
          goal: AM1-like import in AM2 without internet lookup and without covers; deterministic processing + publish + machine-readable
            output.
          includes:
          - CLI 'import' surface (PATH required initially)
          - 'Minimal config keys: library_root (target), yes/non_interactive, (optional) clean_inbox placeholder'
          - 'Pipeline preset for import: validate input -> derive output path -> copy/move to library_root -> emit summary/log'
          acceptance_tests:
          - python -m audiomason import /path/to/input.wav --pipeline <preset-or-spec> exits 0
          - Log file exists and is non-empty when configured
          - Missing input returns non-zero with consistent error
        MVP-1:
          goal: Add DROP_ROOT selection behavior and inbox clean-up.
          includes:
          - drop_root config
          - Enumerate sources under drop_root
          - Interactive selection + deterministic non-interactive mode
          - Implement clean_inbox as move/archive of processed source
        MVP-2:
          goal: Add verify command minimal parity.
          includes:
          - verify scans library_root and checks basic invariants
          - Stable exit codes + report
        MVP-3:
          goal: Add network metadata providers + covers + cache gc.
          includes:
          - OpenLibrary provider
          - GoogleBooks provider
          - Cover retrieval + cache
          - cache gc command
    contracts:
      import_mvp0:
        contract: audiomason2-import-mvp0
        version: '1.0'
        generated_at: '2026-01-23T20:52:14Z'
        scope:
          project: AudioMason2
          basis: Parity analysis vs AudioMason1 (src/ only)
          goal: Minimal AM1-like import capability without network metadata or covers
        cli:
          command: audiomason import PATH
          description: Import audio into library using deterministic pipeline
          arguments:
            PATH:
              required: true
              description: Path to audio file or directory
          options:
            --pipeline:
              required: false
              default: import_mvp0
              description: Pipeline preset or path
            --library-root:
              required: false
              description: Target library root directory
            --yes:
              required: false
              description: Non-interactive mode
            --non-interactive:
              required: false
              description: Alias for --yes
            --json:
              required: false
              description: Emit machine-readable JSON summary to stdout
            --dry-run:
              required: false
              description: Do not perform filesystem changes
          exit_codes:
            '0': Success
            '2': Invalid input path
            '3': Pipeline execution error
            '4': Publish (filesystem) error
        pipeline_presets:
          import_mvp0:
            description: Minimal deterministic import pipeline
            steps:
            - name: validate_input
              responsibility: Validate existence and readability of PATH
            - name: collect_audio_facts
              responsibility: Collect technical audio properties if available; no-op if unsupported
            - name: derive_output_path
              responsibility: Compute deterministic output path under library_root
            - name: publish
              responsibility: Copy input to output path (respects --dry-run)
            - name: emit_summary
              responsibility: Produce log and JSON summary
        summary_schema:
          type: object
          required:
          - status
          - input
          - output
          - warnings
          - errors
          properties:
            status:
              type: string
              enum:
              - ok
              - error
            input:
              type: object
              properties:
                path:
                  type: string
                type:
                  type: string
                  enum:
                  - file
                  - directory
            output:
              type: object
              properties:
                library_root:
                  type: string
                published_paths:
                  type: array
                  items:
                    type: string
            warnings:
              type: array
              items:
                type: string
            errors:
              type: array
              items:
                type: string
        config_contract:
          import:
            library_root:
              type: string
              required: true
            clean_inbox:
              type: boolean
              required: false
              note: Ignored in MVP-0
            non_interactive:
              type: boolean
              required: false
          priority:
          - CLI
          - config
          - defaults
        acceptance_tests:
        - name: basic_import_success
          command: python -m audiomason import tests/fixtures/input.wav --library-root /tmp/lib --json
          expected:
            exit_code: 0
            status: ok
        - name: invalid_input
          command: python -m audiomason import /does/not/exist.wav
          expected:
            exit_code: 2
            status: error
        - name: dry_run
          command: python -m audiomason import tests/fixtures/input.wav --dry-run --json
          expected:
            exit_code: 0
            filesystem_changes: false
      import_mvp1:
        contract: audiomason2-import-mvp1
        version: '1.0'
        generated_at: '2026-01-23T20:54:24Z'
        scope:
          extends: audiomason2-import-mvp0
          goal: Add DROP_ROOT selection + inbox clean-up
        cli:
          command: audiomason import [PATH]
          changes_from_mvp0:
          - PATH becomes optional; if omitted, selection happens under drop_root.
          options_added_or_extended:
            --drop-root:
              required: false
              description: Override configured drop_root for source discovery
            --source:
              required: false
              description: 'Non-interactive: select source by name/index under drop_root (deterministic)'
            --clean-inbox:
              required: false
              description: Override configured clean_inbox behavior for this run
            --archive-dir:
              required: false
              description: 'If clean_inbox enabled, move processed source here (default: <drop_root>/_archived)'
          non_interactive_rules:
          - If PATH omitted and --yes/--non-interactive is set, selection must be deterministic.
          - Deterministic order is lexicographic by path name.
          - If multiple sources exist and neither --source nor a deterministic single-choice rule applies, exit with code
            2 and an error explaining ambiguity.
          exit_codes:
            '0': Success
            '2': Invalid input/selection/ambiguity
            '3': Pipeline execution error
            '4': Publish (filesystem) error
            '5': Inbox cleanup error
        config_contract:
          import:
            drop_root:
              type: string
              required: true
            clean_inbox:
              type: boolean
              required: false
              default: false
            archive_dir:
              type: string
              required: false
          priority:
          - CLI
          - config
          - defaults
        source_discovery:
          definition: A 'source' is a direct child entry under drop_root that is not ignored.
          ignore_rules_minimum:
          - Ignore hidden entries starting with '.'
          - Ignore non-audio files when selecting a file source (if selecting files)
          - Ignore _archived directory
          selection:
            interactive: If not in non-interactive mode, prompt user to select from enumerated sources.
            non_interactive:
            - 'If --source specified: select that source by exact name or numeric index (1-based).'
            - 'Else if exactly one eligible source exists: select it.'
            - 'Else: fail with exit 2 (ambiguity).'
        cleanup:
          when: After successful publish (and only then).
          behavior:
          - 'If clean_inbox false: no cleanup.'
          - 'If clean_inbox true: move processed source to archive_dir (default <drop_root>/_archived/<source_name>).'
          - 'If destination exists: deterministic policy required (fail with exit 5 unless overwrite explicitly supported).'
        acceptance_tests:
        - name: interactive_select
          setup: drop_root has 2 sources
          command: python -m audiomason import --drop-root /tmp/drop
          expected:
            exit_code: 0
        - name: non_interactive_single_source
          setup: drop_root has exactly 1 eligible source
          command: python -m audiomason import --drop-root /tmp/drop --yes --library-root /tmp/lib --json
          expected:
            exit_code: 0
            status: ok
        - name: non_interactive_ambiguous
          setup: drop_root has 2 eligible sources
          command: python -m audiomason import --drop-root /tmp/drop --yes
          expected:
            exit_code: 2
            status: error
        - name: non_interactive_by_source
          setup: drop_root has 2 eligible sources
          command: python -m audiomason import --drop-root /tmp/drop --yes --source 2 --library-root /tmp/lib
          expected:
            exit_code: 0
        - name: cleanup_move_on_success
          setup: clean_inbox enabled; archive_dir empty
          command: python -m audiomason import --drop-root /tmp/drop --yes --library-root /tmp/lib --clean-inbox
          expected:
            exit_code: 0
    design_md: "# \U0001F3A7 Audiomason v2  System Design and Architecture\n\n**Project:** Audiomason v2  \n**Author:** Michal\
      \ Hole  \n**Contact:** [michal@holes.sk](mailto:michal@holes.sk)  \n**Repository:** [github.com/audiomason](https://www.github.com/audiomason)\
      \  \n**License:** MIT  \n**Generated:** 2026-01-15  \n\n---\n\n## \U0001F1EC\U0001F1E7 English Version\n\n### 1. Overview\n\
      \nAudiomason v2 is a complete, modular re-implementation of the original Audiomason 1 system.  \nIt is designed to be\
      \ fast, transparent, asynchronous, and easy to maintain.  \nEvery component has clearly defined boundaries, interfaces,\
      \ and documentation.\n\nCore principles:\n\n- **Modular**  minimal, logically grouped modules only  \n- **Transparent**\
      \  all actions visible in logs (no hidden operations)  \n- **Async & Parallel**  supports concurrent I/O and DAG pipelines\
      \  \n- **Plugin-capable**  extend, modify, or remove any system behavior  \n- **Documented**  YAML + Markdown contracts\
      \ and auto-generated docs  \n- **Cross-platform**  Linux, macOS, Windows, Raspberry Pi OS\n\n---\n\n### 2. Architecture\n\
      \nPerfektn \U0001F3A7  teraz ti vygenerujem druh dokument:\n\U0001F4C4 **`audiomason_v2_design.md`**\n udsky itaten\
      \ architektonick dokumentcia\n obsahovo rovnak ako YAML, ale pre vvojrov a itateov (GitHub formt, sekcie, nadpisy,\
      \ odseky, prklady)\n **anglick verzia prv**, **slovensk verzia druh**\n\n---\n\n### \U0001F4C4 `audiomason_v2_design.md`\n\
      \n```markdown\n# \U0001F3A7 Audiomason v2  System Design and Architecture\n\n**Project:** Audiomason v2  \n**Author:**\
      \ Michal Hole  \n**Contact:** [michal@holes.sk](mailto:michal@holes.sk)  \n**Repository:** [github.com/audiomason](https://www.github.com/audiomason)\
      \  \n**License:** MIT  \n**Generated:** 2026-01-15  \n\n---\n\n## \U0001F1EC\U0001F1E7 English Version\n\n### 1. Overview\n\
      \nAudiomason v2 is a complete, modular re-implementation of the original Audiomason 1 system.  \nIt is designed to be\
      \ fast, transparent, asynchronous, and easy to maintain.  \nEvery component has clearly defined boundaries, interfaces,\
      \ and documentation.\n\nCore principles:\n\n- **Modular**  minimal, logically grouped modules only  \n- **Transparent**\
      \  all actions visible in logs (no hidden operations)  \n- **Async & Parallel**  supports concurrent I/O and DAG pipelines\
      \  \n- **Plugin-capable**  extend, modify, or remove any system behavior  \n- **Documented**  YAML + Markdown contracts\
      \ and auto-generated docs  \n- **Cross-platform**  Linux, macOS, Windows, Raspberry Pi OS\n\n---\n\n### 2. Architecture\n\
      \n```\n\naudiomason/\n core/               # Interfaces, models, contracts\n io/                 # Reading/writing\
      \ files, manifests\n audio/              # Conversions, normalization, splitting\n metadata/           # Reading,\
      \ tagging, enrichment\n pipeline/           # DAG orchestrator\n plugins/            # Plugin manager and loaders\n\
       cli/                # Typer-based CLI\n utils/              # Helpers, profiling\n tests/              # Unit/integration\
      \ tests\n\n````\n\nEach directory represents a single logical domain.  \nModules communicate through defined interfaces\
      \ and the `ProcessingContext`.\n\n---\n\n### 3. Pipeline System\n\nAudiomason uses a **Directed Acyclic Graph (DAG)**\
      \ model for its pipeline.  \nEach step defines inputs, outputs, dependencies, and optional parallel execution.\n\nExample:\n\
      ```yaml\npipeline:\n  - id: import_audio\n  - id: normalize_volume\n    after: [import_audio]\n  - id: enrich_metadata\n\
      \    parallel: true\n  - id: export_book\n    after: [normalize_volume, enrich_metadata]\n````\n\nThe pipeline runs\
      \ asynchronously, with optional profiling and logging in YAML.\n\n---\n\n### 4. Plugin System\n\nPlugins extend Audiomason\
      \ dynamically.\n\n#### Discovery paths:\n\n* `audiomason/plugins/`\n* `~/.audiomason/plugins/`\n* `pyproject.toml` entrypoints\n\
      \n#### Plugin manifest (YAML):\n\n```yaml\nname: whisper\nentrypoint: plugin:WhisperPlugin\nhooks: [pre_import, post_process]\n\
      test_level: strict\n```\n\nPlugins are validated by `mypy`, `pytest`, and `ruff` before activation.\nThey can modify\
      \ or replace any system command, step, or hook.\n\n---\n\n### 5. CLI and Runtime\n\nCLI powered by [Typer](https://typer.tiangolo.com/)\n\
      Commands include:\n\n* `process`  run pipeline\n* `inspect`  show book info\n* `plugins`  list/manage plugins\n*\
      \ `config`  show config sources\n* `daemon`  run watch service\n\n**Verbosity modes:**\n\n| Mode      | Description\
      \                      |\n| --------- | -------------------------------- |\n| `silent`  | minimal logs             \
      \        |\n| `normal`  | standard logs                    |\n| `verbose` | detailed logs (for users)        |\n| `debug`\
      \   | full system trace, internal data |\n\n---\n\n### 6. Configuration System\n\nConfig priority:\n\n1. CLI arguments\n\
      2. Environment variables\n3. User config (`~/.config/audiomason/config.yaml`)\n4. System config (`/etc/audiomason/config.yaml`)\n\
      5. Defaults\n\nExample user config:\n\n```yaml\nffmpeg_path: /usr/bin/ffmpeg\ndefault_bitrate: 128k\noutput_dir: ~/Audiobooks/output\n\
      plugins_dir: ~/.audiomason/plugins\n```\n\n---\n\n### 7. Daemon Mode\n\nAudiomason can run as a background service:\n\
      \n* watches for new files in `/srv/inbox/`\n* processes them periodically\n* outputs to `/srv/output/`\n* logs errors\
      \ to `/srv/error/`\n\nDaemon configuration (`/etc/audiomason/daemon.yaml`):\n\n```yaml\nwatch_folders:\n  - /srv/inbox\n\
      interval_seconds: 30\non_success: move_to_output\non_error: move_to_error\n```\n\n---\n\n### 8. Testing and Quality\n\
      \nAll modules undergo:\n\n* **pytest** (unit/integration)\n* **mypy** (strict)\n* **ruff** (lint)\n\nCI via **GitHub\
      \ Actions**.\nPlugins that fail validation are not loaded.\n\nTargets:\n\n* 95% coverage\n* zero monoliths\n* async\
      \ performance <50ms per step\n* consistent profiling\n\n---\n\n### 9. Distribution\n\nAudiomason v2 will be available\
      \ as:\n\n* `pip install audiomason`\n* `.deb` packages for Debian/Ubuntu\n* `.exe` / `.msi` installer for Windows\n\
      * portable build (zipapp/AppDir)\n\n---\n\n### 10. Documentation and Introspection\n\nModules have `.contract.yaml`\
      \ describing their interfaces:\n\n```yaml\nmodule: audio.normalize\ninputs: [AudioTrack]\noutputs: [NormalizedTrack]\n\
      description: \"Normalizes audio loudness using ffmpeg.\"\n```\n\nCLI tools:\n\n```bash\naudiomason describe audio.normalize\n\
      audiomason explain audio.export\n```\n\n`audiomason docs build` auto-generates YAML + Markdown + HTML docs.\n\n---\n\
      \n## \U0001F1F8\U0001F1F0 Slovensk verzia\n\n### 1. Prehad\n\nAudiomason v2 je kompletn, modulrne a transparentn\
      \ preprogramovanie systmu Audiomason 1.\nJe rchly, asynchrnny, rozriten a ahko udriavaten.\n\nZkladn princpy:\n\
      \n* **Modulrnos**  kad modul je samostatn a logicky ist\n* **Transparentnos**  iadna prca za oponou\n\
      * **Asynchrnnos a paralelnos**  DAG pipeline a I/O lohy beia sbene\n* **Pluginy**  systm rozriten o akkovek\
      \ sprvanie\n* **Dokumentcia**  YAML + Markdown kontrakty\n* **Multiplatformovos**  Linux, macOS, Windows, Raspberry\
      \ Pi\n\n---\n\n### 2. Architektra\n\n```\naudiomason/\n core/       # Zkladn rozhrania a typy\n io/       \
      \  # Sborov opercie\n audio/      # Konverzie, normalizcia\n metadata/   # tanie, tagovanie\n pipeline/\
      \   # Orchestrcia DAG pipeline\n plugins/    # Pluginy a natanie\n cli/        # Prkazov linka\n utils/\
      \      # Pomocn funkcie\n tests/      # Testy\n```\n\nKad modul m presne definovan vstupy a vstupy.\nMedzi\
      \ modulmi sa komunikuje len cez definovan rozhrania.\n\n---\n\n### 3. Pipeline\n\nPipeline pouva model DAG  teda\
      \ graf zvislost medzi krokmi.\nPodporuje paraleln vykonvanie a profilovanie.\n\nPrklad:\n\n```yaml\npipeline:\n\
      \  - id: import_audio\n  - id: normalize_volume\n    after: [import_audio]\n  - id: enrich_metadata\n    parallel: true\n\
      \  - id: export_book\n    after: [normalize_volume, enrich_metadata]\n```\n\n---\n\n### 4. Pluginy\n\nPluginy roziruj\
      \ AM2 poas behu.\nPodporuj YAML manifest, hooky a testovanie.\n\n```yaml\nname: whisper\nentrypoint: plugin:WhisperPlugin\n\
      hooks: [pre_import, post_process]\ntest_level: strict\n```\n\n---\n\n### 5. CLI a beh\n\nCLI (Typer) obsahuje prkazy:\n\
      \n* `process`\n* `inspect`\n* `plugins`\n* `config`\n* `daemon`\n\nReimy vstupu:\n\n| Reim     | Popis          \
      \      |\n| --------- | -------------------- |\n| `silent`  | len kritick chyby   |\n| `normal`  | zkladn informcie\
      \  |\n| `verbose` | rozren vpisy     |\n| `debug`   | pln vvojov vstup |\n\n---\n\n### 6. Konfigurcia\n\nPriorita\
      \ konfigurci:\n\n1. CLI argumenty\n2. Premenn prostredia\n3. Uvatesk config\n4. Systmov config\n5. Predvolen\
      \ hodnoty\n\n---\n\n### 7. Daemon\n\nDmon sleduje prieinky a spracva nov audioknihy.\nKonfigurcia v `/etc/audiomason/daemon.yaml`.\n\
      \n---\n\n### 8. Testovanie\n\nKad modul:\n\n* testovan cez `pytest`\n* typovan cez `mypy`\n* lintovan cez `ruff`\n\
      \nNespen pluginy sa nenataj.\nCie: 95% pokrytie, iadne monolity.\n\n---\n\n### 9. Distribcia\n\nDostupn formy:\n\
      \n* `pip`\n* `.deb`\n* `.exe` / `.msi`\n* portable balek\n\n---\n\n### 10. Dokumentcia\n\nKad modul m `.contract.yaml`.\n\
      Dokumentcia sa generuje cez:\n\n```\naudiomason docs build\n```\n\n---\n\n**End of Document**\n\n"
  from_docs_chaos_zip:
    behavior_catalog: null
    config_overrides_yaml: null
    runtime_md: null
    config_overrides_md: null
evidence_generators:
  pytest_junit:
    description: JUnit XML report generated automatically on every pytest run via pyproject.toml addopts.
    artifact_path: audit/results/pytest_junit.xml
    format: junit_xml
    generation_policy:
      auto_generated: true
      how: Configured in [tool.pytest.ini_options].addopts as --junitxml audit/results/pytest_junit.xml
      when: Every pytest invocation (local gating and CI).
    freshness_policy:
      goal: Avoid using stale evidence from a different code state.
      rule: pytest_junit.xml should be newer than the newest repo file mtime (excluding audit/results).
      fallback_rule: If freshness cannot be computed, accept artifact but reduce confidence and mark reason=STALE_EVIDENCE_UNCHECKED.
pytest_domain_mapping:
  artifact_path: audit/results/pytest_junit.xml
  matching:
    by_test_name_prefix:
      CFG:
      - test_cfg_
      - test_config_
      CLI:
      - test_cli_
      LOG:
      - test_log_
      - test_logging_
      FS:
      - test_fs_
      PIPE:
      - test_pipe_
      - test_pipeline_
      IMPORT:
      - test_import_
      VERIFY:
      - test_verify_
      PREFLIGHT:
      - test_preflight_
      METADATA:
      - test_metadata_
      TAGS:
      - test_tags_
      AUDIO:
      - test_audio_
      COVERS:
      - test_covers_
      PLUGINS:
      - test_plugins_
      UTILS:
      - test_utils_
      DAEMON:
      - test_daemon_
      REPORT:
      - test_report_
    by_path_contains:
      METADATA:
      - tests/metadata
      - test_metadata
      TAGS:
      - tests/tags
      - test_tags
      PLUGINS:
      - tests/plugins
      - test_plugins
  semantics:
    pass: All matched tests pass.
    debt: Any matched test fails/errors.
    unknown: No matched tests found OR junit artifact missing/stale.
